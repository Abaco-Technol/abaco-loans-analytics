{
  "name": "Run KPI regression and statistical tests",
    "on": ["push", "pull_request", { "schedule": [ { "cron": "0 6 * * 1" } ] } ],
  "jobs": {
    "test-kpi": {
      "runs-on": "ubuntu-latest",
      "steps": [
        { "name": "Checkout code", "uses": "actions/checkout@v3" },
        { "name": "Set up Python", "uses": "actions/setup-python@v4", "with": { "python-version": "3.10" } },
        { "name": "Install dependencies", "run": "pip install -r requirements.txt" },
        { "name": "Install test/stat packages", "run": "pip install pytest scipy statsmodels" },
        { "name": "Run regression tests", "run": "pytest tests/data_tests/ --junitxml=results.xml" },
        { "name": "Upload test results", "uses": "actions/upload-artifact@v3", "with": { "name": "kpi-test-results", "path": "results.xml" } },
        { "name": "Notify on failure", "if": "failure()", "run": "echo 'KPI regression/statistical tests failed!'" }
      ]
    }
  }
}
